var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};function e(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}function r(t){return"function"==typeof t}var n=!1,i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){n=t},get useDeprecatedSynchronousErrorHandling(){return n}};function o(t){setTimeout(function(){throw t})}var s={closed:!0,next:function(t){},error:function(t){if(i.useDeprecatedSynchronousErrorHandling)throw t;o(t)},complete:function(){}},c=Array.isArray||function(t){return t&&"number"==typeof t.length};function u(t){return null!==t&&"object"==typeof t}function a(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}a.prototype=Object.create(Error.prototype);var h=a,l=function(){function t(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var n=this._parent,i=this._parents,o=this._unsubscribe,s=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var a=-1,l=i?i.length:0;n;)n.remove(this),n=++a<l&&i[a]||null;if(r(o))try{o.call(this)}catch(r){e=!0,t=r instanceof h?p(r.errors):[r]}if(c(s))for(a=-1,l=s.length;++a<l;){var f=s[a];if(u(f))try{f.unsubscribe()}catch(r){e=!0,t=t||[],r instanceof h?t=t.concat(p(r.errors)):t.push(r)}}if(e)throw new h(t)}},t.prototype.add=function(e){var r=e;switch(typeof e){case"function":r=new t(e);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof t)){var n=r;(r=new t)._subscriptions=[n]}break;default:if(!e)return t.EMPTY;throw new Error("unrecognized teardown "+e+" added to Subscription.")}if(r._addParent(this)){var i=this._subscriptions;i?i.push(r):this._subscriptions=[r]}return r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.prototype._addParent=function(t){var e=this._parent,r=this._parents;return e!==t&&(e?r?-1===r.indexOf(t)&&(r.push(t),!0):(this._parents=[t],!0):(this._parent=t,!0))},t.EMPTY=((e=new t).closed=!0,e),t}();function p(t){return t.reduce(function(t,e){return t.concat(e instanceof h?e.errors:e)},[])}var f="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),d=function(t){function r(e,n,i){var o=t.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=s;break;case 1:if(!e){o.destination=s;break}if("object"==typeof e){e instanceof r?(o.syncErrorThrowable=e.syncErrorThrowable,o.destination=e,e.add(o)):(o.syncErrorThrowable=!0,o.destination=new b(o,e));break}default:o.syncErrorThrowable=!0,o.destination=new b(o,e,n,i)}return o}return e(r,t),r.prototype[f]=function(){return this},r.create=function(t,e,n){var i=new r(t,e,n);return i.syncErrorThrowable=!1,i},r.prototype.next=function(t){this.isStopped||this._next(t)},r.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},r.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},r.prototype._next=function(t){this.destination.next(t)},r.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},r.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},r.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this},r}(l),b=function(t){function n(e,n,i,o){var c,u=t.call(this)||this;u._parentSubscriber=e;var a=u;return r(n)?c=n:n&&(c=n.next,i=n.error,o=n.complete,n!==s&&(r((a=Object.create(n)).unsubscribe)&&u.add(a.unsubscribe.bind(a)),a.unsubscribe=u.unsubscribe.bind(u))),u._context=a,u._next=c,u._error=i,u._complete=o,u}return e(n,t),n.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;i.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},n.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=i.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):o(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;o(t)}}},n.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};i.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},n.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),i.useDeprecatedSynchronousErrorHandling)throw t;o(t)}},n.prototype.__tryOrSetError=function(t,e,r){if(!i.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return i.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(o(e),!0)}return!1},n.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},n}(d),y="function"==typeof Symbol&&Symbol.observable||"@@observable";function v(){}var m=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n=this.operator,o=function(t,e,r){if(t){if(t instanceof d)return t;if(t[f])return t[f]()}return t||e||r?new d(t,e,r):new d(s)}(t,e,r);if(o.add(n?n.call(o,this.source):this.source||i.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),i.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){i.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){var e=t.destination;if(t.closed||t.isStopped)return!1;t=e&&e instanceof d?e:null}return!0}(t)?t.error(e):console.warn(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=w(e))(function(e,n){var i;i=r.subscribe(function(e){try{t(e)}catch(t){n(t),i&&i.unsubscribe()}},n,e)})},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[y]=function(){return this},t.prototype.pipe=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return 0===e.length?this:((t=e)?1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)}:v)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=w(t))(function(t,r){var n;e.subscribe(function(t){return n=t},function(t){return r(t)},function(){return t(n)})})},t.create=function(e){return new t(e)},t}();function w(t){if(t||(t=Promise),!t)throw new Error("no Promise impl found");return t}function g(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}g.prototype=Object.create(Error.prototype);var S=g,_=function(t){function r(e,r){var n=t.call(this)||this;return n.subject=e,n.subscriber=r,n.closed=!1,n}return e(r,t),r.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}},r}(l),E=function(t){function r(e){var r=t.call(this,e)||this;return r.destination=e,r}return e(r,t),r}(d),x=function(t){function r(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return e(r,t),r.prototype[f]=function(){return new E(this)},r.prototype.lift=function(t){var e=new P(this,this);return e.operator=t,e},r.prototype.next=function(t){if(this.closed)throw new S;if(!this.isStopped)for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].next(t)},r.prototype.error=function(t){if(this.closed)throw new S;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].error(t);this.observers.length=0},r.prototype.complete=function(){if(this.closed)throw new S;this.isStopped=!0;for(var t=this.observers,e=t.length,r=t.slice(),n=0;n<e;n++)r[n].complete();this.observers.length=0},r.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},r.prototype._trySubscribe=function(e){if(this.closed)throw new S;return t.prototype._trySubscribe.call(this,e)},r.prototype._subscribe=function(t){if(this.closed)throw new S;return this.hasError?(t.error(this.thrownError),l.EMPTY):this.isStopped?(t.complete(),l.EMPTY):(this.observers.push(t),new _(this,t))},r.prototype.asObservable=function(){var t=new m;return t.source=this,t},r.create=function(t,e){return new P(t,e)},r}(m),P=function(t){function r(e,r){var n=t.call(this)||this;return n.destination=e,n.source=r,n}return e(r,t),r.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},r.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},r.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},r.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):l.EMPTY},r}(x);function j(){return function(t){return t.lift(new T(t))}}var T=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var r=this.connectable;r._refCount++;var n=new L(t,r),i=e.subscribe(n);return n.closed||(n.connection=r.connect()),i},t}(),L=function(t){function r(e,r){var n=t.call(this,e)||this;return n.connectable=r,n}return e(r,t),r.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var r=this.connection,n=t._connection;this.connection=null,!n||r&&n!==r||n.unsubscribe()}}else this.connection=null},r}(d),O=function(t){function r(e,r){var n=t.call(this)||this;return n.source=e,n.subjectFactory=r,n._refCount=0,n._isComplete=!1,n}return e(r,t),r.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},r.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},r.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new l).add(this.source.subscribe(new R(this.getSubject(),this))),t.closed?(this._connection=null,t=l.EMPTY):this._connection=t),t},r.prototype.refCount=function(){return j()(this)},r}(m).prototype,N={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:O._subscribe},_isComplete:{value:O._isComplete,writable:!0},getSubject:{value:O.getSubject},connect:{value:O.connect},refCount:{value:O.refCount}},R=function(t){function r(e,r){var n=t.call(this,e)||this;return n.connectable=r,n}return e(r,t),r.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},r.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},r.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},r}(E),A=function(t){function r(e){var r=t.call(this)||this;return r._value=e,r}return e(r,t),Object.defineProperty(r.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),r.prototype._subscribe=function(e){var r=t.prototype._subscribe.call(this,e);return r&&!r.closed&&e.next(this._value),r},r.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new S;return this._value},r.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},r}(x),C=new m(function(t){return t.complete()});function I(t){return t?function(t){return new m(function(e){return t.schedule(function(){return e.complete()})})}(t):C}function M(t){return t&&"function"==typeof t.schedule}var U=function(t){return function(e){for(var r=0,n=t.length;r<n&&!e.closed;r++)e.next(t[r]);e.closed||e.complete()}};function k(t,e){return new m(e?function(r){var n=new l,i=0;return n.add(e.schedule(function(){i!==t.length?(r.next(t[i++]),r.closed||n.add(this.schedule())):r.complete()})),n}:U(t))}function H(t){var e=new m(function(e){e.next(t),e.complete()});return e._isScalar=!0,e.value=t,e}function q(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[t.length-1];switch(M(r)?t.pop():r=void 0,t.length){case 0:return I(r);case 1:return r?k(t,r):H(t[0]);default:return k(t,r)}}function V(t){return t}function $(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}$.prototype=Object.create(Error.prototype);var D=$;function Y(t,e){return function(r){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new F(t,e))}}var F=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new B(t,this.project,this.thisArg))},t}(),B=function(t){function r(e,r,n){var i=t.call(this,e)||this;return i.project=r,i.count=0,i.thisArg=n||i,i}return e(r,t),r.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},r}(d),K=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.notifyNext=function(t,e,r,n,i){this.destination.next(e)},r.prototype.notifyError=function(t,e){this.destination.error(t)},r.prototype.notifyComplete=function(t){this.destination.complete()},r}(d),W=function(t){function r(e,r,n){var i=t.call(this)||this;return i.parent=e,i.outerValue=r,i.outerIndex=n,i.index=0,i}return e(r,t),r.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},r.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},r.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},r}(d),X=function(t){return function(e){return t.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,o),e}};function z(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var G=z(),J=function(t){return function(e){for(var r=t[G]();;){var n=r.next();if(n.done){e.complete();break}if(e.next(n.value),e.closed)break}return"function"==typeof r.return&&e.add(function(){r.return&&r.return()}),e}},Q=function(t){return function(e){var r=t[y]();if("function"!=typeof r.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return r.subscribe(e)}},Z=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function tt(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var et=function(t){if(t instanceof m)return function(e){return t._isScalar?(e.next(t.value),void e.complete()):t.subscribe(e)};if(t&&"function"==typeof t[y])return Q(t);if(Z(t))return U(t);if(tt(t))return X(t);if(t&&"function"==typeof t[G])return J(t);var e=u(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+e+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function rt(t,e,r,n,i){if(void 0===i&&(i=new W(t,r,n)),!i.closed)return et(e)(i)}function nt(t,e){if(!e)return t instanceof m?t:new m(et(t));if(null!=t){if(function(t){return t&&"function"==typeof t[y]}(t))return function(t,e){return new m(e?function(r){var n=new l;return n.add(e.schedule(function(){var i=t[y]();n.add(i.subscribe({next:function(t){n.add(e.schedule(function(){return r.next(t)}))},error:function(t){n.add(e.schedule(function(){return r.error(t)}))},complete:function(){n.add(e.schedule(function(){return r.complete()}))}}))})),n}:Q(t))}(t,e);if(tt(t))return function(t,e){return new m(e?function(r){var n=new l;return n.add(e.schedule(function(){return t.then(function(t){n.add(e.schedule(function(){r.next(t),n.add(e.schedule(function(){return r.complete()}))}))},function(t){n.add(e.schedule(function(){return r.error(t)}))})})),n}:X(t))}(t,e);if(Z(t))return k(t,e);if(function(t){return t&&"function"==typeof t[G]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new m(e?function(r){var n,i=new l;return i.add(function(){n&&"function"==typeof n.return&&n.return()}),i.add(e.schedule(function(){n=t[G](),i.add(e.schedule(function(){if(!r.closed){var t,e;try{var i=n.next();t=i.value,e=i.done}catch(t){return void r.error(t)}e?r.complete():(r.next(t),this.schedule())}}))})),i}:J(t))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}function it(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"function"==typeof e?function(n){return n.pipe(it(function(r,n){return nt(t(r,n)).pipe(Y(function(t,i){return e(r,t,n,i)}))},r))}:("number"==typeof e&&(r=e),function(e){return e.lift(new ot(t,r))})}var ot=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new st(t,this.project,this.concurrent))},t}(),st=function(t){function r(e,r,n){void 0===n&&(n=Number.POSITIVE_INFINITY);var i=t.call(this,e)||this;return i.project=r,i.concurrent=n,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return e(r,t),r.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},r.prototype._tryNext=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e,t,r)},r.prototype._innerSub=function(t,e,r){var n=new W(this,void 0,void 0);this.destination.add(n),rt(this,t,e,r,n)},r.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},r.prototype.notifyNext=function(t,e,r,n,i){this.destination.next(e)},r.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},r}(K);function ct(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),it(V,t)}function ut(t){return new m(function(e){var r;try{r=t()}catch(t){return void e.error(t)}return(r?nt(r):I()).subscribe(e)})}function at(t,e,n,i){return r(n)&&(i=n,n=void 0),i?at(t,e,n).pipe(Y(function(t){return c(t)?i.apply(void 0,t):i(t)})):new m(function(r){!function t(e,r,n,i,o){var s;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(e)){var c=e;e.addEventListener(r,n,o),s=function(){return c.removeEventListener(r,n,o)}}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(e)){var u=e;e.on(r,n),s=function(){return u.off(r,n)}}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(e)){var a=e;e.addListener(r,n),s=function(){return a.removeListener(r,n)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var h=0,l=e.length;h<l;h++)t(e[h],r,n,i,o)}i.add(s)}(t,e,function(t){r.next(arguments.length>1?Array.prototype.slice.call(arguments):t)},r,n)})}function ht(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Number.POSITIVE_INFINITY,n=null,i=t[t.length-1];return M(i)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(r=t.pop())):"number"==typeof i&&(r=t.pop()),null===n&&1===t.length&&t[0]instanceof m?t[0]:ct(r)(k(t,n))}var lt=new m(v),pt=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new ft(t,this.resultSelector))},t}(),ft=function(t){function r(e,r,n){void 0===n&&(n=Object.create(null));var i=t.call(this,e)||this;return i.iterators=[],i.active=0,i.resultSelector="function"==typeof r?r:null,i.values=n,i}return e(r,t),r.prototype._next=function(t){var e=this.iterators;c(t)?e.push(new bt(t)):e.push("function"==typeof t[G]?new dt(t[G]()):new yt(this.destination,this,t))},r.prototype._complete=function(){var t=this.iterators,e=t.length;if(this.unsubscribe(),0!==e){this.active=e;for(var r=0;r<e;r++){var n=t[r];n.stillUnsubscribed?this.destination.add(n.subscribe(n,r)):this.active--}}else this.destination.complete()},r.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},r.prototype.checkIterators=function(){for(var t=this.iterators,e=t.length,r=this.destination,n=0;n<e;n++)if("function"==typeof(s=t[n]).hasValue&&!s.hasValue())return;var i=!1,o=[];for(n=0;n<e;n++){var s,c=(s=t[n]).next();if(s.hasCompleted()&&(i=!0),c.done)return void r.complete();o.push(c.value)}this.resultSelector?this._tryresultSelector(o):r.next(o),i&&r.complete()},r.prototype._tryresultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},r}(d),dt=function(){function t(t){this.iterator=t,this.nextResult=t.next()}return t.prototype.hasValue=function(){return!0},t.prototype.next=function(){var t=this.nextResult;return this.nextResult=this.iterator.next(),t},t.prototype.hasCompleted=function(){var t=this.nextResult;return t&&t.done},t}(),bt=function(){function t(t){this.array=t,this.index=0,this.length=0,this.length=t.length}return t.prototype[G]=function(){return this},t.prototype.next=function(t){var e=this.index++;return e<this.length?{value:this.array[e],done:!1}:{value:null,done:!0}},t.prototype.hasValue=function(){return this.array.length>this.index},t.prototype.hasCompleted=function(){return this.array.length===this.index},t}(),yt=function(t){function r(e,r,n){var i=t.call(this,e)||this;return i.parent=r,i.observable=n,i.stillUnsubscribed=!0,i.buffer=[],i.isComplete=!1,i}return e(r,t),r.prototype[G]=function(){return this},r.prototype.next=function(){var t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}},r.prototype.hasValue=function(){return this.buffer.length>0},r.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},r.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},r.prototype.notifyNext=function(t,e,r,n,i){this.buffer.push(e),this.parent.checkIterators()},r.prototype.subscribe=function(t,e){return rt(this,this.observable,this,e)},r}(K);function vt(t){return function(e){var r=new mt(t),n=e.lift(r);return r.caught=n}}var mt=function(){function t(t){this.selector=t}return t.prototype.call=function(t,e){return e.subscribe(new wt(t,this.selector,this.caught))},t}(),wt=function(t){function r(e,r,n){var i=t.call(this,e)||this;return i.selector=r,i.caught=n,i}return e(r,t),r.prototype.error=function(e){if(!this.isStopped){var r=void 0;try{r=this.selector(e,this.caught)}catch(e){return void t.prototype.error.call(this,e)}this._unsubscribeAndRecycle();var n=new W(this,void 0,void 0);this.add(n),rt(this,r,void 0,void 0,n)}},r}(K),gt=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new St(t,this.compare,this.keySelector))},t}(),St=function(t){function r(e,r,n){var i=t.call(this,e)||this;return i.keySelector=n,i.hasKey=!1,"function"==typeof r&&(i.compare=r),i}return e(r,t),r.prototype.compare=function(t,e){return t===e},r.prototype._next=function(t){var e;try{var r=this.keySelector;e=r?r(t):t}catch(t){return this.destination.error(t)}var n=!1;if(this.hasKey)try{n=(0,this.compare)(this.key,e)}catch(t){return this.destination.error(t)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))},r}(d);function _t(t,e){return function(r){return r.lift(new Et(t,e))}}var Et=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new xt(t,this.predicate,this.thisArg))},t}(),xt=function(t){function r(e,r,n){var i=t.call(this,e)||this;return i.predicate=r,i.thisArg=n,i.count=0,i}return e(r,t),r.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},r}(d);function Pt(t,e,r){return function(n){return n.lift(new jt(t,e,r))}}var jt=function(){function t(t,e,r){this.nextOrObserver=t,this.error=e,this.complete=r}return t.prototype.call=function(t,e){return e.subscribe(new Tt(t,this.nextOrObserver,this.error,this.complete))},t}(),Tt=function(t){function n(e,n,i,o){var s=t.call(this,e)||this;return s._tapNext=v,s._tapError=v,s._tapComplete=v,s._tapError=i||v,s._tapComplete=o||v,r(n)?(s._context=s,s._tapNext=n):n&&(s._context=n,s._tapNext=n.next||v,s._tapError=n.error||v,s._tapComplete=n.complete||v),s}return e(n,t),n.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.next(t)},n.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)},n.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},n}(d),Lt=function(){function t(t){if(this.total=t,this.total<0)throw new D}return t.prototype.call=function(t,e){return e.subscribe(new Ot(t,this.total))},t}(),Ot=function(t){function r(e,r){var n=t.call(this,e)||this;return n.total=r,n.count=0,n}return e(r,t),r.prototype._next=function(t){var e=this.total,r=++this.count;r<=e&&(this.destination.next(t),r===e&&(this.destination.complete(),this.unsubscribe()))},r}(d),Nt=function(){function t(t){this.callback=t}return t.prototype.call=function(t,e){return e.subscribe(new Rt(t,this.callback))},t}(),Rt=function(t){function r(e,r){var n=t.call(this,e)||this;return n.add(new l(r)),n}return e(r,t),r}(d);function At(t){return function(e){return e.lift(new Ct(t))}}var Ct=function(){function t(t){this.value=t}return t.prototype.call=function(t,e){return e.subscribe(new It(t,this.value))},t}(),It=function(t){function r(e,r){var n=t.call(this,e)||this;return n.value=r,n}return e(r,t),r.prototype._next=function(t){this.destination.next(this.value)},r}(d),Mt=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new Ut(t))},t}(),Ut=function(t){function r(e){var r=t.call(this,e)||this;return r.hasPrev=!1,r}return e(r,t),r.prototype._next=function(t){this.hasPrev?this.destination.next([this.prev,t]):this.hasPrev=!0,this.prev=t},r}(d);function kt(){return new x}function Ht(){return function(t){return j()((e=kt,function(t){var r;r="function"==typeof e?e:function(){return e};var n=Object.create(t,N);return n.source=t,n.subjectFactory=r,n})(t));var e}}function qt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var r=t[t.length-1];M(r)?t.pop():r=null;var n=t.length;return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ct(1)(q.apply(void 0,t))}(1!==n||r?n>0?k(t,r):I(r):H(t[0]),e)}}function Vt(t,e){return"function"==typeof e?function(r){return r.pipe(Vt(function(r,n){return nt(t(r,n)).pipe(Y(function(t,i){return e(r,t,n,i)}))}))}:function(e){return e.lift(new Dt(t))}}var $t,Dt=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new Yt(t,this.project))},t}(),Yt=function(t){function r(e,r){var n=t.call(this,e)||this;return n.project=r,n.index=0,n}return e(r,t),r.prototype._next=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this._innerSub(e,t,r)},r.prototype._innerSub=function(t,e,r){var n=this.innerSubscription;n&&n.unsubscribe();var i=new W(this,void 0,void 0);this.destination.add(i),this.innerSubscription=rt(this,t,e,r,i)},r.prototype._complete=function(){var e=this.innerSubscription;e&&!e.closed||t.prototype._complete.call(this),this.unsubscribe()},r.prototype._unsubscribe=function(){this.innerSubscription=null},r.prototype.notifyComplete=function(e){this.destination.remove(e),this.innerSubscription=null,this.isStopped&&t.prototype._complete.call(this)},r.prototype.notifyNext=function(t,e,r,n,i){this.destination.next(e)},r}(K),Ft=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var r=new Bt(t),n=rt(r,this.notifier);return n&&!r.seenValue?(r.add(n),e.subscribe(r)):r},t}(),Bt=function(t){function r(e){var r=t.call(this,e)||this;return r.seenValue=!1,r}return e(r,t),r.prototype.notifyNext=function(t,e,r,n,i){this.seenValue=!0,this.complete()},r.prototype.notifyComplete=function(){},r}(K),Kt=function(){function t(t,e){this.observables=t,this.project=e}return t.prototype.call=function(t,e){return e.subscribe(new Wt(t,this.observables,this.project))},t}(),Wt=function(t){function r(e,r,n){var i=t.call(this,e)||this;i.observables=r,i.project=n,i.toRespond=[];var o=r.length;i.values=new Array(o);for(var s=0;s<o;s++)i.toRespond.push(s);for(s=0;s<o;s++){var c=r[s];i.add(rt(i,c,c,s))}return i}return e(r,t),r.prototype.notifyNext=function(t,e,r,n,i){this.values[r]=e;var o=this.toRespond;if(o.length>0){var s=o.indexOf(r);-1!==s&&o.splice(s,1)}},r.prototype.notifyComplete=function(){},r.prototype._next=function(t){if(0===this.toRespond.length){var e=[t].concat(this.values);this.project?this._tryProject(e):this.destination.next(e)}},r.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},r}(K);function Xt({protocol:t,host:e},r=window.location){return t!==r.protocol||e!==r.host}function zt(){const t=document.documentElement,e=document.body,r="scrollHeight";return t[r]||e[r]}function Gt(){return window.pageYOffset||document.body.scrollTop}function Jt(t){return t&&""===t.target}function Qt({url:{pathname:t}},{url:{pathname:e,hash:r},cause:n}){return e===t&&(n===$t.Pop||n===$t.Push&&""!==r)}!function(t){t.Init="init",t.Hint="hint",t.Push="push",t.Pop="pop"}($t||($t={}));class Zt{constructor(t){this.parent=t}get animPromise(){return this.parent.animPromise}fetchPage(t){return(e=t.url.href,r={method:"GET",mode:"cors",headers:{Accept:"text/html"}},m.create(t=>{const n=new AbortController,{signal:i}=n;let o=null;return fetch(e,Object.assign({},r,{signal:i})).then(e=>{o=e,t.next(e),t.complete()}).catch(e=>t.error(e)),()=>{o||n.abort()}})).pipe(Vt(t=>t.text()),Y(e=>Object.assign({},t,{response:e})),vt(e=>q(Object.assign({},t,{error:e,response:null}))));var e,r}selectPrefetch({href:t},e,r){return t===e.url.href&&null==e.error?q(e):r.pipe((1,function(t){return t.lift(new Lt(1))}))}getResponse(t,e,r){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[t.length-1];return"function"==typeof r&&t.pop(),k(t,void 0).lift(new pt(r))}(this.selectPrefetch(e.url,r,t),this.animPromise,t=>Object.assign({},t,e))}}class te{constructor(t){this.parent=t}get scriptSelector(){return this.parent.scriptSelector}tempRemoveScriptTags(t){const e=[];return t.forEach(t=>t.querySelectorAll(this.scriptSelector).forEach(t=>{const r=[t,t.previousSibling];t.parentNode.removeChild(t),e.push(r)})),e}insertScript([t,e]){return document.write=((...t)=>{const r=document.createElement("div");r.innerHTML=t.join(),Array.from(r.childNodes).forEach(t=>{e.parentNode.insertBefore(t,e.nextSibling)})}),""!==t.src?m.create(r=>{t.addEventListener("load",t=>(r.next(t),r.complete())),t.addEventListener("error",t=>r.error(t)),e.parentNode.insertBefore(t,e.nextSibling)}):q({}).pipe(Pt(()=>{e.parentNode.insertBefore(t,e.nextSibling)}))}reinsertScriptTags(t){if(!this.scriptSelector)return Promise.resolve(t);const e=document.write,{scripts:r}=t;return nt(r).pipe((i=(t=>this.insertScript(t)),it(i,void 0,1)),vt(e=>q(Object.assign({},t,{error:e}))),(n=(()=>document.write=e),function(t){return t.lift(new Nt(n))})).toPromise().then(()=>t);var n,i}}class ee{constructor(t){this.parent=t}get href(){return this.parent.href}rewriteURLs(t){t.forEach(t=>{t.querySelectorAll("[href]").forEach(this.rewriteURL("href")),t.querySelectorAll("[src]").forEach(this.rewriteURL("src")),t.querySelectorAll("img[srcset]").forEach(this.rewriteURLSrcSet("srcset")),t.querySelectorAll("blockquote[cite]").forEach(this.rewriteURL("cite")),t.querySelectorAll("del[cite]").forEach(this.rewriteURL("cite")),t.querySelectorAll("ins[cite]").forEach(this.rewriteURL("cite")),t.querySelectorAll("q[cite]").forEach(this.rewriteURL("cite")),t.querySelectorAll("img[longdesc]").forEach(this.rewriteURL("longdesc")),t.querySelectorAll("frame[longdesc]").forEach(this.rewriteURL("longdesc")),t.querySelectorAll("iframe[longdesc]").forEach(this.rewriteURL("longdesc")),t.querySelectorAll("img[usemap]").forEach(this.rewriteURL("usemap")),t.querySelectorAll("input[usemap]").forEach(this.rewriteURL("usemap")),t.querySelectorAll("object[usemap]").forEach(this.rewriteURL("usemap")),t.querySelectorAll("form[action]").forEach(this.rewriteURL("action")),t.querySelectorAll("button[formaction]").forEach(this.rewriteURL("formaction")),t.querySelectorAll("input[formaction]").forEach(this.rewriteURL("formaction")),t.querySelectorAll("video[poster]").forEach(this.rewriteURL("poster")),t.querySelectorAll("object[data]").forEach(this.rewriteURL("data")),t.querySelectorAll("object[codebase]").forEach(this.rewriteURL("codebase")),t.querySelectorAll("object[archive]").forEach(this.rewriteURLList("archive"))})}rewriteURL(t){return e=>{try{e.setAttribute(t,new URL(e.getAttribute(t),this.href).href)}catch(t){}}}rewriteURLSrcSet(t){return e=>{try{e.setAttribute(t,e.getAttribute(t).split(/\s*,\s*/).map(t=>{const e=t.split(/\s+/);return e[0]=new URL(e[0],this.href).href,e.join(" ")}).join(", "))}catch(t){}}}rewriteURLList(t){return e=>{try{e.setAttribute(t,e.getAttribute(t).split(/[\s,]+/).map(t=>new URL(t,this.href).href).join(", "))}catch(t){}}}}class re{constructor(t){this.parent=t,this.urlRewriter=new ee(t),this.scriptManager=new te(t)}get el(){return this.parent.el}get replaceSelector(){return this.parent.replaceSelector}get scriptSelector(){return this.parent.scriptSelector}getTitle(t){return(t.querySelector("title")||{textContent:""}).textContent}getReplaceElements(t){if(this.replaceSelector)return this.replaceSelector.split(",").map(e=>t.querySelector(e));if(this.el.id)return[t.getElementById(this.el.id)];{const e=Array.from(document.getElementsByTagName(this.el.tagName)).indexOf(this.el);return[t.querySelectorAll(this.el.tagName)[e]]}}responseToContent(t){try{const{response:r}=t,n=(e=r,document.createRange().createContextualFragment(e)),i=this.getTitle(n),o=this.getReplaceElements(n),s=this.scriptSelector?this.scriptManager.tempRemoveScriptTags(o):[];return Object.assign({},t,{documentFragment:n,title:i,replaceEls:o,scripts:s})}catch(t){console.error(t)}var e}replaceContentWithSelector(t){this.replaceSelector.split(",").map(t=>document.querySelector(t)).forEach((e,r)=>e.parentNode.replaceChild(t[r],e))}replaceContentWholesale([t]){this.el.innerHTML=t.innerHTML}replaceContent(t){this.scriptSelector?this.replaceContentWithSelector(t):this.replaceContentWholesale(t)}updateDOM(t){try{const{replaceEls:e}=t;Xt(this.parent)&&this.urlRewriter.rewriteURLs(e),this.replaceContent(e)}catch(e){throw Object.assign({},t,{error:e})}}reinsertScriptTags(t){return this.scriptManager.reinsertScriptTags(t)}}const ne=t=>new Promise(e=>setTimeout(e,t));class ie{constructor(t){this.parent=t}get animPromise(){return this.parent.animPromise}set animPromise(t){this.parent.animPromise=t}get duration(){return this.parent.duration}onStart(t){this.animPromise=ne(this.duration),this.parent.start.emit(Object.assign({},t,{transitionUntil:t=>{this.animPromise=t}}))}emitDOMError(t){console.log(t.error);const{replaceElMissing:e,url:r}=t;e?(window.history.back(),setTimeout(()=>document.location.href=r,100)):this.parent.error.emit(t)}emitNetworkError(t){this.parent.networkerror.emit(t)}emitError(t){console.log(t.error),this.parent.error.emit(t)}emitReady(t){this.parent.ready.emit(t)}emitAfter(t){this.parent.after.emit(t)}emitProgress(t){this.parent.progress.emit(t)}emitLoad(t){this.parent.load.emit(t)}}class oe{constructor(t){this.parent=t}updateHistoryState({cause:t,replace:e,url:{href:r}}){if(!Xt(this.parent))switch(t){case $t.Init:case $t.Push:{const t=this.parent.histId(),n=Object.assign({},window.history.state,{[t]:{}});e||r===window.location.href?window.history.replaceState(n,document.title,r):window.history.pushState(n,document.title,r)}}}updateHistoryStateHash({cause:t,url:e}){if(!Xt(this.parent)&&t===$t.Push){const t=this.parent.histId();window.history.pushState({[t]:{}},document.title,e.href)}}updateHistoryTitle({cause:t,title:e}){document.title=e,Xt(this.parent)||t!==$t.Push||window.history.replaceState(window.history.state,e,window.location.href)}updateHistoryScrollPosition(){if(Xt(this.parent))return;const t=this.assignScrollPosition(window.history.state||{});window.history.replaceState(t,document.title,window.location.href)}assignScrollPosition(t){const e=this.parent.histId();return Object.assign({},t,{[e]:Object.assign({},t[e],{scrollTop:Gt(),scrollHeight:zt()})})}}class se{constructor(t){this.parent=t}manageScrollPostion({cause:t,url:{hash:e}}){switch(t){case $t.Push:this.scrollHashIntoView(e,{behavior:"smooth",block:"start",inline:"nearest"});break;case $t.Pop:this.restoreScrollPostion();break;case $t.Init:this.restoreScrollPostionOnReload()}}scrollHashIntoView(t,e){if(t){const r=document.getElementById(decodeURIComponent(t.substr(1)));r&&r.scrollIntoView(e)}else window.scroll(window.pageXOffset,0)}restoreScrollPostion(){const t=this.parent.histId(),{scrollTop:e}=window.history.state&&window.history.state[t]||{};null!=e&&window.scroll(window.pageXOffset,e)}restoreScrollPostionOnReload(){0!=Gt()||this.restoreScrollPostion()}}class ce{constructor(){this.linkSelector="a[href]:not([data-no-push])",this.prefetch=!1,this.duration=0,this.initialHref=window.location.href,this.scrollManager=new se(this),this.historyManager=new oe(this),this.fetchManager=new Zt(this),this.updateManager=new re(this),this.eventManager=new ie(this),this.reload$=new x,this.cacheNr=0}setLinkSelector(t){this.linkSelector$.next(t)}setPrefetch(t){this.prefetch$.next(t)}get hash(){return this.url.hash}get host(){return this.url.host}get hostname(){return this.url.hostname}get href(){return this.url.href}get origin(){return this.url.origin}get pathname(){return this.url.pathname}get port(){return this.url.port}get protocol(){return this.url.protocol}get search(){return this.url.search}get ancestorOrigins(){return window.location.ancestorOrigins}histId(){return this.el.id||this.el.tagName}assign(t){this.reload$.next({cause:$t.Push,url:new URL(t,this.href),cacheNr:++this.cacheNr})}reload(){this.reload$.next({cause:$t.Push,url:new URL(this.href),cacheNr:++this.cacheNr,replace:!0})}replace(t){this.reload$.next({cause:$t.Push,url:new URL(t,this.href),cacheNr:++this.cacheNr,replace:!0})}compareContext(t,e){return t.url.href===e.url.href&&t.error===e.error&&t.cacheNr===e.cacheNr}componentWillLoad(){this.linkSelector$=new A(this.linkSelector),this.prefetch$=new A(this.prefetch),this.setupEventListeners();const t={},e=ht(this.pushEvent$.pipe(Y(([t,e])=>({cause:$t.Push,url:new URL(e.href,this.href),anchor:e,event:t,cacheNr:this.cacheNr})),_t(t=>(function({url:t,anchor:e,event:{metaKey:r,ctrlKey:n}},i){return!r&&!n&&Jt(e)&&!Xt(t,i)})(t,this)),Pt(({event:t})=>{t.preventDefault(),this.historyManager.updateHistoryScrollPosition()})),at(window,"popstate").pipe(_t(()=>window.history.state&&window.history.state[this.histId()]),Y(t=>({cause:$t.Pop,url:new URL(window.location.href,this.href),event:t,cacheNr:this.cacheNr}))),this.reload$).pipe(qt({url:new URL(this.initialHref)}),Pt(({url:t})=>this.url=t),function(t){return t.lift(new Mt)},Ht()),r=e.pipe(_t(t=>!Qt(...t)),Y(([,t])=>t),Ht()),n=e.pipe(_t(t=>Qt(...t)),Y(([,t])=>t)),i=ut(()=>ht(r.pipe(At(!0)),t.response$.pipe(At(!1)))).pipe(qt(!1)),o=ht(this.prefetch$.pipe(Vt(t=>t?this.hintEvent$.pipe(function(t){return e=>t.pipe(Vt(t=>t?lt:e))}(i),Y(([t,e])=>({cause:$t.Hint,url:new URL(e.href,this.href),anchor:e,event:t,cacheNr:this.cacheNr})),_t(t=>(function({url:t,anchor:e},r){return Jt(e)&&!Xt(t,r)&&!function({hash:t,origin:e,pathname:r},n=window.location){return""!==t&&e===n.origin&&r===n.pathname}(t,r)})(t,this))):lt)),r).pipe((s=((t,e)=>this.compareContext(t,e)),function(t){return t.lift(new gt(s,void 0))}),Vt(t=>this.fetchManager.fetchPage(t)),qt({url:{}}),Ht());var s;const c=t.response$=r.pipe(Pt(t=>{this.historyManager.updateHistoryState(t),this.eventManager.onStart(t)}),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var r;return"function"==typeof t[t.length-1]&&(r=t.pop()),e.lift(new Kt(t,r))}}(o),Vt(t=>this.fetchManager.getResponse(o,...t)),Ht()),u=c.pipe(_t(({error:t})=>!t)),a=c.pipe(_t(({error:t})=>t));u.pipe(Y(t=>this.updateManager.responseToContent(t)),Pt(t=>{this.eventManager.emitReady(t),this.updateManager.updateDOM(t),this.historyManager.updateHistoryTitle(t),this.scrollManager.manageScrollPostion(t),this.eventManager.emitAfter(t)}),Pt({error:t=>this.eventManager.emitDOMError(t)}),vt((t,e)=>e),Vt(t=>this.updateManager.reinsertScriptTags(t)),Pt({error:t=>this.eventManager.emitError(t)}),vt((t,e)=>e)).subscribe(t=>this.eventManager.emitLoad(t)),n.subscribe(t=>{this.historyManager.updateHistoryStateHash(t),this.scrollManager.manageScrollPostion(t)}),a.subscribe(t=>this.eventManager.emitNetworkError(t)),r.pipe(Vt(t=>ut(()=>this.animPromise).pipe(function(t){return function(e){return e.lift(new Ft(t))}}(c),At(t)))).subscribe(t=>this.eventManager.emitProgress(t))}static get is(){return"hy-push-state"}static get properties(){return{assign:{method:!0},duration:{type:Number,attr:"duration",reflectToAttr:!0,mutable:!0},el:{elementRef:!0},initialHref:{type:String,attr:"initial-href",mutable:!0},linkSelector:{type:String,attr:"link-selector",reflectToAttr:!0,mutable:!0,watchCallbacks:["setLinkSelector"]},prefetch:{type:Boolean,attr:"prefetch",reflectToAttr:!0,mutable:!0,watchCallbacks:["setPrefetch"]},reload:{method:!0},replace:{method:!0},replaceSelector:{type:String,attr:"replace-selector",reflectToAttr:!0,mutable:!0},scriptSelector:{type:String,attr:"script-selector",reflectToAttr:!0,mutable:!0}}}static get events(){return[{name:"start",method:"start",bubbles:!0,cancelable:!0,composed:!0},{name:"ready",method:"ready",bubbles:!0,cancelable:!0,composed:!0},{name:"after",method:"after",bubbles:!0,cancelable:!0,composed:!0},{name:"progress",method:"progress",bubbles:!0,cancelable:!0,composed:!0},{name:"load",method:"load",bubbles:!0,cancelable:!0,composed:!0},{name:"error",method:"error",bubbles:!0,cancelable:!0,composed:!0},{name:"networkerror",method:"networkerror",bubbles:!0,cancelable:!0,composed:!0}]}}var ue;ue=ce,[class{setupEventListeners(){if(this.pushEvent$=at(this.el,"click").pipe(Y(t=>{const e=function(e,r){let n=t.target;for(;null!=n;){if(n.matches(r))return n;n=n.parentNode instanceof Element?n.parentNode:null}return null}(0,this.linkSelector);if(e instanceof HTMLAnchorElement)return[t,e]}),_t(t=>!!t)),"MutationObserver"in window&&"Set"in window){const n=new Set,i=new x;this.hintEvent$=i;const o=t=>i.next([t,t.currentTarget]),s=t=>{n.has(t)||(n.add(t),t.addEventListener("mouseenter",o,{passive:!0}),t.addEventListener("touchstart",o,{passive:!0}),t.addEventListener("focus",o,{passive:!0}))},c=t=>{t instanceof Element&&(t.matches(this.linkSelector)?s(t):t.querySelectorAll(this.linkSelector).forEach(s))},u=t=>{n.delete(t),t.removeEventListener("mouseenter",o),t.removeEventListener("touchstart",o),t.removeEventListener("focus",o)},a=t=>{t instanceof Element&&(t.matches(this.linkSelector)?u(t):t.querySelectorAll(this.linkSelector).forEach(u))};this.linkSelector$.subscribe(()=>{n.forEach(u),c(this.el)}),(e=this.el,r={childList:!0,subtree:!0},m.create(t=>{const n=new MutationObserver(e=>e.forEach(e=>t.next(e)));return n.observe(e,r),()=>{n.disconnect()}})).pipe(qt({addedNodes:[this.el],removedNodes:[]}),Pt({complete(){n.forEach(u)}}),(t=this.prefetch$,e=>t.pipe(Vt(t=>t?e:lt)))).subscribe(({addedNodes:t,removedNodes:e})=>{e.forEach(a),t.forEach(c)})}var t,e,r}}].forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(e=>{ue.prototype[e]=t.prototype[e]})});export{ce as HyPushState};